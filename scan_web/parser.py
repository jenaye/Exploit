import requests
import sys
import urllib2

NotFound = '\033[91m'
StopColor = '\033[0m'

Found = '\033[92m'
Warning = '0\33[33m]'

def main(argv):	
# add verbose mod, and colors, add possitility to export into file 

	
	default_header = ['Strict-Transport-Security','X-Powered-By','Security-Policy', 'X-Frame-Options', 'Content-Type', 'X-XSS-Protection', 'Access-Control-Allow-Origin', 'Last-Modified', 'Access-Control-Allow-Credentials', 'Set-Cookie'];
	r = requests.get(sys.argv[1])
	print(Found)
	print "Response status : ", r.status_code
	print(StopColor)
	print( Found +"Server found : " + r.headers.get('Server') + StopColor)
	#print(r.headers)
	in_dict(default_header, r.headers)


def in_dict(listHeader, ResponseHeader):

	for header in listHeader:
		if header in ResponseHeader:
			print(Found+ "Header: "+ header + " FOUND" + StopColor)
		else:
			print(NotFound + "Header: " + header + " NOT FOUND " + StopColor)
			if("X-XSS-Protection" == header):
				print(Warning + '------------------')
				print("----xss should works--")
				print('------------------' + StopColor)
			if("Strict-Transport-Security" == header):
				print(Warning + '-------------------------------')
				print("-website can be called as http-")
				print('-------------------------------' + StopColor)


if __name__ == "__main__":

   main(sys.argv)
